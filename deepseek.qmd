---
title:  "DeepSeek辅助统计分析和R运用"
date: today
author: 
  name: "Li Zongzhang"
  url: https://space.bilibili.com/590872906/
format: 
  revealjs:
    incremental: FALSE
    theme: sky
    slide-number: true
    code-fold: true
    center: false
    execute:
      echo: true
      output: true        
      warning: false
      message: false
    chalkboard: 
      buttons: true
    preview-links: auto
    css: styles.css
    footer: |
      <https://lizongzhang.github.io/mvs25><br>© 2025 Li Zongzhang 
    include-before-body: 
      - header.html
      - fonts.html
    title-slide-attributes: 
      data-background-image: "img/bili_up.JPG"  
      data-background-size: "100px"        
      data-background-position: "center bottom 200px"  
    plugins: [highlight, zoom, notes]
editor: 
  markdown: 
    wrap: 72
---


```{r}
#| echo: FALSE

par(family  = 'STKaiti')
library(showtext)
showtext_auto()

```

---

## 大纲 {auto-animate="true"}

-   1 DeepSeek助力：重塑统计学习方式

-   2 DeepSeek辅助统计方法学习和运用

-   3 DeepSeek辅助论文统计分析写作

-   4 DeepSeek辅助统计分析和R运用

---

## 1.1 与DeepSeek协作：重塑统计学习方式

-   不知道该用什么统计方法？

-   看不懂输出结果

-   为写论文而发愁

💡 理念重塑: 从“工具”到“伙伴”:

-   “我不会统计方法” ➡️ “我会提问”

-   “我不会用R/STATA/Python” ➡ “在AI辅助下我能”

-   “我写不好论文中的统计部分” ➡ “我能借助 AI表达、优化”

--------


## 2 DeepSeek辅助统计方法学习和运用

-   重构统计学习方式
    -   互动式

    -   针对性

    -   不要撒网式学习

## 2.1 DeepSeek如何助力统计学习？

-   统计学习的重心
    -   基础知识(本科课程已涵盖)
        -   变量类型: 定性(无序/有序), 定量(离散/连续)
        -   参数估计: 置信水平，置信区间
        -   假设检验: 双/单侧检验，显著性水平, p值, 临界值, 检验统计量
    -   方法选择
    -   结果解读

-------

## 2.2 统计基础知识补遗

### 🎯 **提问句式**

> 🧭 提示语: 请用最通俗的方式解释“统计术语”

> 🧭 提示语: 请用数值模拟解释“统计术语”，并提供 R
> 代码与详细解释，以便更直观地理解。

------

### 🔍 示例1 什么是置信水平？

> 🧭 提示语: 用最通俗的方式解释什么是置信水平？

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.1eg1.png)
:::

-----

### 🔍 示例1 什么是置信水平？

> 🧭 提示语:
> 请用数值模拟上述解释过程，让我理解起来更加容易。给出数值模拟的R代码，并加以解释。

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.1eg2.png)
:::

-------

### 🔍 示例1 什么是置信水平？

> 🧭 提示语:
> 请用数值模拟上述解释过程，让我理解起来更加容易。给出数值模拟的R代码，并加以解释。

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.1eg3.png)
:::

------

### 🔍 示例2 se和sd的区别

> 🧭 提示语: standar error 和 standard deviation
> 有什么区别？请用最通俗的方式解释。

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.1eg4.png)
:::

------

### 🔍 示例2 se和sd的区别

> 🧭 提示语: standar error 和 standard deviation
> 有什么区别？请用最通俗的方式解释。

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.1eg5.png)
:::

------

### 📘 权威期刊建议

::: {.callout-note title="推荐做法"}
《Nature》、《Cell》、《JAMA》、《NEJM》 等权威期刊明确建议：

> 柱状图或点图的误差线应使用 **标准误差（SE）** 或
> **置信区间（CI）**，而非 **标准差（SD）**，以避免误导读者。

:::

::: {.callout-note title="参考文献"}

> Cumming G, Fidler F, Vaux DL. (2007). [Error bars in experimental
> biology](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2064100/). The
> Journal of Cell Biology, 177(1):7–11.

> 该文指出：**SD
> 描述数据变异性，而非估计均值的可信度**，因此在展示组间比较时使用 SE 或
> CI 更有解释力。

:::

------

## 2.3 重构统计学习方式：从被动学习到主动建构

💡 不再是“学完了才能用”，而是“在用中学习，在问中学”

📕️ 传统模式：教科书主导，学生被动接受

-   教材编什么，读者学什么\
-   顺着教材目录走，忽视了**统计思维**的培养、“统计写作”能力的训练

🚀 DeepSeek模式：需求驱动，Prompt引导学习

-   先有问题，后找方法

-   不再强调公式/计算/软件操作，而是**围绕科研任务主动构建统计能力**

>  📌 **统计学习的未来，不是依靠更全面系统的教材，而是善于利用AI工具的引导。**

---

## 2.4 从统计学习者到提问专家：如何与 DeepSeek 高效对话？

-   DeepSeek可以回答"如何做"

-   选择方法, 解释结果, 润色语言

-   DeepSeek无法判断统计分析结论的“现实意义”

-   ① 它不了解社会经济语境

    -   无法判断1.2%的收入增长是否有社会学意义
    -   无法判断失业率降低3%是否足以推动政策调整
    -   无法判断某项干预措施对社会群体是否“可感知”

-   ② 它无法识别研究的局限

    -   样本的代表性
    -   数据质量
    -   研究全貌

--------

### 🔍 示例3 deepseek与研究者的角色分工

> **新政策试点地区居民平均收入增加了530元，对照地区为420元，差异为110元，P = 0.002。**

-   **DeepSeek的判断**：P值小于0.05，说明两地区在收入增长上存在统计学显著差异。


-   **研究者需要进一步判断**：

    -   平均增加110元，对居民的生活水平是否有重要作用？
    -   实施该政策是否伴有更高的财政成本或管理难度？
    -   如果仅对特定人群有效，是否有必要全国推广？
    -   在政策制定过程中，该差异是否足以改变现有社会保障方案或经济刺激政策？

> 📌 要评估“统计显著”的“现实价值”，需结合居民反馈、政策成本、可持续性以及对社会决策的实际影响。

-------

### ① 低质量提问的特点

-   **太笼统**：“我这组数据怎么分析？”——没有说明变量、设计、目的；
-   **背景缺失**：没有交代样本量、变量类型、研究目标等关键信息；
-   **术语模糊**：用“数字”, “分组”代替“连续变量”“独立样本”等标准术语；
-   **目的不清**：是要选方法？还是要解释P值？甚至只是想画图？

-------

### ② 如何构建高质量提问？

-   **研究背景**：研究设计、样本量、数据来源

-   **变量**：类型（定性/定量）、分布特征（正态/非正态）、数据结构（截面/重复测量/分层/生存数据等）

-   **提问目标**：你希望DeepSeek帮你做什么？推荐方法？解释输出？润色语言？

-------

### 🔍 示例4 高质量提问

💡 **明确表达研究背景、变量类型和分析目的**

-   **原问法**：我做了线性回归，能不能帮我看看有没有问题？\
    **优化提问**：我用线性回归分析家庭收入对学生学术成绩的影响因素，自变量包括父母教育水平、学习时长和学校类型，模型输出如下，请帮我判断变量解释是否合理，并协助我撰写结果描述。

-------


-   **原问法**：我想知道两组学生有无差异，用什么方法好？\
    **优化提问**：我想比较在线教学和传统课堂对学生参与度的效果，两组样本独立，结局变量是非正态分布的参与分数，请问适合使用哪种非参数检验方法？

-------


-   **原问法**：这个 P 值怎么解读？\
    **优化提问**：使用 logistic 回归分析收入水平对低收入群体投票参与的影响（因变量为是否参与投票，二元变量），变量“收入水平”（分类为低/中/高）的 OR = 1.9（中收入 vs. 低收入），95% CI 为 1.1–3.2，P = 0.025，请帮我解释这个变量在模型中的统计意义（包括置信区间和显著性），以及其对社会不平等政策启示的实际含义。

-------

### 🎯 **提问句式**

-   **研究背景**（如研究设计、样本量、数据来源）

-   **变量类型、数据结构、分布特征**（如定量、定性、是否正态）

-   **分析目的**（比较差异、建模预测、描述分布等）

-   **希望 AI 协助的具体环节**（方法选择、结果解读、语言撰写等）

--------

## 从工具到能力，构建AI辅助统计思维

-   统计学习不只是掌握方法，更是形成解决问题的思维方式。

-   DeepSeek不只是工具，更可以成为统计学习与科研写作的智能伙伴。

-   借助 AI，可以加速理解、提升效率，但不能替代判断与思考。

-   真正有效的统计学习，应注重：

    -   明确目标（用AI解决具体问题）；
    -   精准提问（提升与AI对话质量）；
    -   灵活应用（将建议转化为科研能力）。

> 📌 从“学习统计”到“用统计解决问题”

-------

## 2.5 DeepSeek辅助统计方法的学习和运用

-   统计方法全景图

-   DeepSeek如何辅助统计方法选择？

-   DeepSeek如何辅助结果解读？

------

## 统计方法全景图

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/map.png)
:::

## DeepSeek如何辅助选择统计方法？


✅ 研究目的: 描述/推断/比较/预测/因果推断

✅ 数据结构: 横截面/纵向/分层/RCT/生存数据等

✅ 变量类型: 定性变量(无序/有序), 定量变量(离散/连续)

✅ 变量地位：结局变量/自变量/协变量

✅ 变量分布：正态/非正态/泊松分布等

✅ 样本容量

-------

### 数据结构

| 数据结构 | 时间特征 | 是否追踪 | 应用场景示例 |
|---------------|-----------------------|---------------|-------------------|
| 横断面研究 | 单时间点 | 无追踪 | 居民收入现状、消费习惯调查 |
| 分组对照研究 | 单时间点（回顾性暴露） | 无追踪 | 政策受益群体与未受益群体比较 |
| 干预试验 | 多时间点（基线+随访） | 干预后追踪 | 最低工资调整后的就业变化 |
| 队列研究 | 多时间点（前瞻或回顾） | 长期追踪 | 教育政策影响的长期收入变化 |
| 登记研究 | 多时间点（通常前瞻） | 长期追踪 | 常年人口流动、宏观经济数据 |

------

### 统计方法与样本容量

| 统计方法               | 样本容量建议                |
|------------------------|-----------------------------|
| **t检验（独立样本）**  | 每组 ≥ 30（≥15 可接受）     |
| **配对t检验**          | ≥ 15 对（≥30 理想）         |
| **方差分析（ANOVA）**  | 每组 ≥ 20–30                |
| **卡方检验**           | 每格期望值 ≥ 5              |
| **Fisher精确检验**     | 总样本 \< 40                |
| **Mann-Whitney U检验** | 每组 ≥ 10–15                |
| **Logistic回归**       | 每类结局 ≥ 10×变量数（EPV） |
| **Cox回归模型**        | ≥ 10 个事件/变量            |
| **线性回归**           | 总样本 ≥ 15×变量数          |
| **倾向评分匹配**       | 匹配后每组 ≥ 100+           |

> **注**：以上为经验性参考，正式研究请结合效应量、α、Power
> 等进行样本量计算。

-------

### ① 如何向DeepSeek描述你的研究问题？

🎯 将“社会经济问题”转换为“统计问题”

社会经济问题：自然语言描述

-   “比较两种就业政策对失业率的影响”

-   “新补贴政策是否能提高低收入家庭的消费水平”


🎯 提问句式

**研究目的**：描述 / 推断/ 比较 / 预测 / 因果推断
**研究对象**：样本单位（如患者、标本等）
**自变量**：变量类型：（如两组、三组、分层等） **因变量**：变量类型：
是否连续 / 分类 / 计数 **特殊说明**：如样本量、分布形态、是否配对等

-------

### 🔍 示例4 差异比较

> 比较两种降压药对收缩压的影响，自变量为“药物类型”（两组），因变量为“收缩压”（连续变量），各组分别有40人，需要使用什么统计分析方法？

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg1.png)
:::

-------

### 🔍 示例5 影响因素分析

🩺 临床问题

> 探讨年龄、性别、住院天数、治疗方案是否与患者出院时的功能恢复水平有关。功能恢复分为三级：**良好
> / 一般 / 差**。

🎯 提问句式

- **研究目的**：预测, 推断\

- **研究对象**：康复科出院患者\

- **因变量**：功能恢复水平（有序分类变量，共3级）\

- **自变量**：年龄(连续), 性别(二分类),
    住院天数(连续),治疗方案(无序分类，共3种)\

- **特殊说明**：
    -   样本：150 人\
    -   因变量具有自然顺序(良好 \> 一般 \> 差)，但间距不等\
    -   希望控制混杂并分析预测因子

-------

### 🔍 示例5 影响因素分析

> “我有150名康复患者的数据，记录了年龄、性别、住院天数和治疗方案（3种，无序分类）。我想分析这些因素对出院时功能恢复水平（良好/一般/差）的影响。因变量是有序分类变量。需要用什么统计分析方法？”

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2.png)
:::


------------------------------------------------------------------------

## deepseek辅助深入学习统计方法

-   追问统计分析过程细节

-   追问检验方法的细节

-   追问图形工具的细节

-   追问如何评估模型拟合效果

------------------------------------------------------------------------

### ① 如何向DeepSeek 追问统计分析过程的细节？

🎯 提问句式

针对**方法/模型，还可以做哪些检验或者绘制可视化图形，来深入探讨**方法/模型的估计结果，提供有价值的研究发现？请参考学术文献的主流做法，回答上述问题。

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_method_detail.png)
:::

------------------------------------------------------------------------

### ① 向DeepSeek 追问统计分析过程的细节

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_method_spss.png)
:::

------------------------------------------------------------------------

### ② 向deepseek追问检验方法的细节

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_method_detail2.png)
:::

-----------------

### ③ 向deepseek追问图形工具的细节

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_method_detail3.png)
:::

----------

### ④向deepseek追问如何评估模型拟合效果

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_method_detail4.png)
:::

------------------------------------------------------------------------

### ⑤ DeepSeek如何辅助结果解读？

-   统计学意义：系数含义
-   现实意义：临床相关性、实际应用价值

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_result1.png)
:::

------------------------------------------------------------------------

### ⑤ DeepSeek如何辅助结果解读？

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_result2.png)
:::

----------

### ⑤ DeepSeek如何辅助结果解读？

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_result3.png)
:::

-------

### ⑥ DeepSeek提供优化统计分析的建议

🎯 提问句式

我的样本数据、选用的变量、估计方法是否存在局限性？请提出改进建议。

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/9.2_eg2_result4.png)
:::

------------------------------------------------------------------------

## DeepSeek辅助统计方法的学习和运用

-   将“现实问题”转换为“统计问题”

    -   提问句式：研究目的 + 研究对象 + 自变量 + 因变量 + 特殊说明

-   追问统计分析过程的细节

    -   方法/模型，还可以做哪些检验或者绘制可视化图形？请参考学术文献的主流做法，回答上述问题。

-   追问检验方法的细节

-   追问图形工具的细节

-   追问如何评估模型拟合效果

-   关于输出结果的解读

    -   统计学意义：P值、效应量、置信区间
    -   临床学意义：临床相关性、实际应用价值

-   优化统计分析的建议

    -   样本数据、选用的变量、估计方法是否存在局限性？请提出改进建议

-----------------


## 3 DeepSeek辅助统计写作

-   建立自己的提示词库

-   建立自己的范文库

-   不要忙于统计分析，而疏于写作

💡 统计写作不是“最后一步”，而是每一步统计分析的**记录、反馈与构建**。

---

### 3.1 建立自己的提示词库



- **方法提示词**  
  针对经管实际问题，整理一套高效提示词，有助于快速、准确地向DeepSeek或其他AI工具提问：
  - 统计方法适用条件（如正态性、独立性、变量类型）
  - 数据结构说明（横截面/面板/分组/干预实验等，明确具体应用场景）
  - 合理样本容量评估（如何判断样本量足够，是否满足统计功效要求）
  - 估计结果解释（如“系数是否具有经济意义？”、“回归模型的拟合优度如何？”）
  - 需要做的检验（如异方差检验、相关性检验、鲁棒性检验、假设检验选择）
  - 可视化工具选择（条形图、散点图、回归曲线、分布密度图等在R中的代码模板）

---

- **写作提示词**  
  用于高效产出论文各部分结构，提高写作条理性，也方便AI工具生成结构化文本：
  - **数据**：数据来源、样本构成、变量定义与描述性统计
  - **方法**：统计分析方法选择理由、建模思路、变量处理、假设构建等
  - **结果**：主要分析结果、统计意义、经济/社会解释、图表表现
  - **讨论**：结论解读、与文献比较、局限性、建议或政策含义

---

### 3.2 建立自己的范文库

- **范文库建立意义**  
  系统收藏高水平期刊和经典研究中的数据、方法、结果、讨论部分范例，为论文写作积累素材和格式参考。
- **范文库收集策略**
  - 针对自己的研究领域、主题或方法，收集5–10篇近年高水平论文。
  - 关注数据截取、模型描述、结果解读、政策含义提炼等优秀表述。
  - 用标签分类：如“回归分析写法”、“政策评价案例”、“结果讨论亮点”等。
- **范文库使用方法**
  - 分析参考范文的结构和语言风格，逐条总结常用表达模板。
  - 在AI生成文本或自己写作时，优先参考范文库中的表述和结构。
  - 鼓励原创，每次写作都积累和更新自己的范文整理。

---

### 3.3 写作与分析的协同

- **不要只“忙于统计分析”，而忽略写作过程**  
  经管论文写作不只是统计结果的汇报，更是逻辑、价值和现实意义的清晰呈现。
- **边分析边写作**  
  - 每完成一段数据处理、回归分析或可视化，就立刻转化为书面表达，记录思路和分析结果。
  - 避免分析过程遗忘，保证结果与写作逻辑的衔接和准确表达。
- **初稿不求完美**  
  - 先快速写出每个部分的初稿，不以语言完美为目标，可以稍显粗糙。
  - 使用DeepSeek或其他AI工具逐步润色、结构优化、语法纠错，提升专业性和可读性。

---

### 3.4 统计写作的核心理念

💡 统计写作不是“最后一步”
- 统计写作是每一步分析的**实时记录、反馈与优化过程**。
- 每一项数据处理、每一次模型选择、每一次结果输出，都应直接转化为写作内容。
- 把统计分析和论文写作理解为“交互式迭代”，而不是线性的完成与交接，让研究和写作同步提升。

---

### 3.5 实用建议与扩展方向

- 积极构建个人写作和模型提示模板，形成独有的“写作助手”
- 经常复盘范文，提升逻辑和表达能力，不断优化自身论文结构
- 善用AI辅助工具，既提升效率也保证专业性
- 关注论文完整性，包括数据、方法、结果、讨论四大版块的连贯统一

----

## 4 DeepSeek辅助R运用

----

-   4.1 DeepSeek辅助R语言快速入门

-   4.2 R语言编程特点

-   4.3 DeepSeek辅助R语言统计分析

-   4.4 DeepSeek辅助R语言学习

------------

## 4.1 DeepSeek辅助R语言快速入门

-   4.1.1 为什么用DeepSeek学R？

-   4.1.2 人人都能用R了！一个简单的示例

-   4.1.3 DeepSeek教不会什么？这几点你得自己掌握

------------------------------------------------------------------------

## 4.1.1 为什么用DeepSeek学R

-   R语言是一门强大但语法灵活的编程语言，对初学者有一定门槛。

-   DeepSeek具备自然语言理解与代码生成能力：

    -   快速生成代码

    -   解释代码, 报错寻因, 解读结果

    -   扩展功能包、实现复杂流程

-   进入“AI辅助编程”时代，将改变R语言的学习方式，从"查命令"转为"提问题"。

------------------------------------------------------------------------

### 4.1.1 传统的R学习方式

-   Book：Wickham H, Grolemund G. R for data science, R for Data Science (2e) [https://r4ds.hadley.nz/](https://r4ds.hadley.nz/){target="_blank"}

-   Book：Wickham H, ggplot2: Elegant Graphics for Data Analysis (3e) [https://ggplot2-book.org/](https://ggplot2-book.org/){target="_blank"}

-   查看R帮助

-   搜索引擎

------------------------------------------------------------------------

### 4.1.1 DeepSeek为何擅长R语言教学？

-   自然语言驱动，降低编程门槛

-   目标导向学习，突出“做事”而非“记语法”

-   学习者只需描述“我想要分析...”，DeepSeek便可完成：

    -   数据清洗/统计分析/结果解读

    -   实时解释与错因分析，促进理解

    -   解释代码/诊断报错/优化代码

-   支持复合任务，一步生成完整工作流

    -   缺失值处理/画图/计算和检验/生成文字报告

------------------------------------------------------------------------

### R帮助文档 VS DeepSeek的回答对比

::::::: columns
:::: {.column width="50%"}
::: {style="max-height: 500px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
<img src="img/10.1.1pic1.png" style="width: 100%;"/>
:::
::::

:::: {.column width="50%"}
::: {style="max-height: 500px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
<img src="img/10.1.1pic2.png" style="width: 100%;"/>
:::
::::
:::::::

------------------------------------------------------------------------

## 4.1.2 人人都能用R了！一个简单的示例

> 🧭 提示语: 用iris数据，进行方差分析，给出R代码。

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/10.1.1pic3.png)
:::

------------------------------------------------------------------------

## 4.1.3 DeepSeek教不会什么？这几点你得自己掌握

-   RStudio主界面

-   如何高效管理文件？

    -   项目project

-   在写R代码的实践中积累的“经验”

    -   📚 如何读懂 R 的帮助文档

    -   📚 如何写一段"漂亮聪明"的代码

        -   简洁/可复制性

        -   美观/易读(代码注释、分节)

    -   📚 如何用最少的代码完成最多的任务

        -   编程思维的形成

        -   学习高手写的代码

-----------

### 漂亮的代码

-   赋值符用\<-, 不用=。=只用于函数参数的赋值

-   逗号后面空格，逗号前不空格(与英文句子中逗号的使用一致)

-   =、==、+、-、\<-, \~, %\>%，｜等用空格包围

-   具有高优先级的运算符包括：::、:::、\$、\@、\[、\[\[、\^，不用空格包围

-   一行代码不要太长

------------

## 4.2 R语言编程特点--优势

-   免费

-   可重复性

-   扩展包

    -   按任务浏览R包：[https://cran.r-project.org/web/views/](https://cran.r-project.org/web/views/){target="_blank"}

    -   R包下载排行榜: [https://www.r-pkg.org/](https://www.r-pkg.org/){target="_blank"}

-   学术前沿

-------------

## 4.2 R语言编程特点--挑战

-   入门难

-   代码容易忘

    -   注释/R自带的提示性键入

-   包太多/难以选择

    -   问DeepSeek：R中能做XXX的有哪些包？比较这些包？哪个更好用？
    -   🎯 专为 R 用户定制的搜索引擎 [https://rseek.org](https://rseek.org){blank="_blank"}
        -   📚 快速找到函数用法、R 包文档、代码示例
        -   ✅ 搜索结果只与 R 有关，不混杂其他语言

-   报错

    -   AI可以帮你分析报错信息

------------------------------------------------------------------------

### 如何选择R包？

> 🧭 提示语：比较可以实现XXX分析的包，哪个最好？

::: {style="height: 600px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;"}
![](img/10.2pic1.png)
:::

--------

## 4.3 DeepSeek辅助R语言统计分析

4.3.1 先看看R能做什么？

4.3.2 绘图

4.3.3 检验

4.3.4 建模

4.3.5 表格化输出

4.3.6 如何让DeepSeek分析自己的数据？

------------------------------------------------------------------------

### 利用R自带数据集

> 🧭 提示语：R中有哪些数据集可以做XX分析？

查看R中的自带的数据集

R中什么包可以做生存分析？这个包中可以做生存分析的数据有哪些？

``` r
# 查看R自带数据
data()

# 查看指定的包中的数据
data(package = "ggplot2")
```

------------------------------------------------------------------------

## 4.3.1 先看看R能做什么？

> 🧭 提示语：利用iris数据，可以开展哪些统计分析，写出R代码。

------------------------------------------------------------------------

## 4.3.2 绘图

> 🧭 绘图提示语

-   用R绘制iris的箱线图

-   按species定性变量分组，绘制petal.length的箱线图。

-   按species分组，绘制箱线图，用ggplot2绘制。

-   让上述多个个图形显示在同一窗口。

-   绘制具有学术期刊风格的分组箱线图。

-   用ggpubr绘制分组箱线图。

------------------------------------------------------------------------

### 🧭 提示语: 利用iris, 绘制具有学术期刊风格的分组箱线图

DeepSeek输出的代码

```{r}
#| echo: TRUE
#| fig-width: 15
#| fig-height: 8
#| collapse: TRUE

# 加载所需的包
library(ggpubr)

# 使用内置的 iris 数据集
data(iris)

# 绘制分组箱线图
ggboxplot(iris, x = "Species", y = "Sepal.Length", 
          color = "Species", palette = "jco", 
          add = "jitter", 
          main = "Iris 数据集的分组箱线图",
          xlab = "物种", ylab = "萼片长度")

```

------------------------------------------------------------------------

### 🧭 提示语: 如何在图中标注两个总体均值的差异是否显著？

继续追问，提出对图形细节上的要求，DeepSeek修改前一段代码。

```{r}
#| echo: TRUE
#| fig-width: 15
#| fig-height: 8
#| collapse: TRUE

# 加载所需的包
library(ggpubr)

# 使用内置的 iris 数据集
data(iris)

# 绘制分组箱线图
ggboxplot(iris, x = "Species", y = "Sepal.Length", 
          color = "Species", palette = "jco", 
          add = "jitter", 
          main = "Iris 数据集的分组箱线图",
          xlab = "物种", ylab = "萼片长度") +
  stat_compare_means(comparisons = list(c("setosa", "versicolor"), c("versicolor", "virginica")),
                       method = "t.test", 
                     label = "p.format",
                     hide.ns = TRUE) 
```

------------------------------------------------------------------------

## 4.3.3 检验

检验：目的/数据容量/数据类型和分布/原假设和备择假设/局限/结论

> 🧭 提示语

-   按species分组，检验不同组别的petal.length的均值是否相等？。

-   该数据满足ANOVA检验的适用条件吗？

-   每个组别内的petal.length观测值是否近似正态分布？

-   如何进行方差齐性检验是什么？

-   bartlett.test()函数的结果如何看？

-   若不同组别之间的petal.length观测值方差不等，还能用ANOVA检验吗？

-   Welch’s ANOVA的命令是什么？

------------------------------------------------------------------------

## 4.3.4 建模

模型：目的/数据容量/数据类型和分布/估计结果的解释/可视化工具/评估

> 🧭 提示语

-   描述判别函数适合的研究场景？

-   利用iris数据，开展判别分析，写出R代码，并添加注释。

-   判别分析中需要做哪些检验？

-   判别分析中有哪些可视化工具？

-   如何评估判别分析模型？

-   有哪些前沿方法可以替代判别分析？R中有哪些包可以实现这类前沿方法？

------------------------------------------------------------------------

## 4.3.5 表格化输出

> 🧭 提示语

-   利用iris数据，如何输出学术论文中的表1（描述性统计表）？

-   利用mpg数据，如何输出学术论文中的回归估计结果的表格？

-   利用survival包中的数据lung，输出学术论文中的基线特征表？

-   利用survival包中的数据lung，用表格报告Cox比例风险模型的估计结果？

-   用别的更简便的方法吗？用专门的包实现表格化输出吗？

--------

## 4.3.6 如何让DeepSeek分析自己的数据？

-   生成模拟数据

> 🧭 提示语: 我有实验组和对照组各10人的服药后7天，14天和21天的血压数据，可以开展什么统计分析，来判断药物是否有效？

> 🧭 提示语: 请在R中生成上述模拟数据，及实现Repeated Measures ANOVA的代码？

-   数据脱敏

    -   数据扰动: 给定量变量增加一个5%的随机扰动

        -   =C2 \* (1 + (RAND() - 0.5) \* 0.1) (Excel公式)

    -   随机抽样 30% \~ 70%： =rand() 然后排序 (Excel)

    -   <a href="https://github.com/lizongzhang/mvs25/raw/main/stroke.xlsx" download="stroke.xlsx">点击下载数据脱敏练习文件: stroke.xlsx</a>

------------------------------------------------------------------------

## 4.4 DeepSeek辅助R语言学习

4.4.1 理解消化代码

4.4.2 代码细节的追问

4.4.3 解决报错

4.4.4 简化/美化代码

4.4.5 整理代码/重复利用

------------------------------------------------------------------------

## 4.4.1 理解消化代码

-   逐行阅读代码并理解每个函数

-   逐步运行代码, 理解输出结果

-   理解复杂符号，如管道符, \[\[\]\], 占位符.等

-   测试不同的参数

------------------------------------------------------------------------

## 4.4.2 代码细节的追问

-   让DeepSeek辅助理解函数帮助

-   赋值符\<- 和 等于= 的区别？

-   %\>% 和 ｜\> 的区别？



<img src="img/video.png" alt="讲义" style="width: 24px; height: 24px;margin-right: 10px">[R语言两种形式的管道符 %>% 和 |>：二者的区别和该用哪种？](https://www.bilibili.com/video/BV1TK421a7tQ/){target="_blank"}


------------------------------------------------------------------------

## 4.4.3 解决报错

-   典型报错错：“未找到函数”、“对象未定义”、“无法读取文件”等

    -   查看环境：确保对象存在

    -   加载相关包

-   函数输入的参数的类型错误

-   复制Console中的代码及报错, 发送给DeepSeek

------------------------------------------------------------------------

## 4.4.4 简化/美化代码

-   使用适当的命名

    -   可以包含字母, 数字,下划线_和小圆点., 但不能以数字开头，不能有中划线-，特殊符号\$,@等

-   避免使用不必要的中间变量

    -   管道符

-   避免重复代码

    -   优化数据结构/循环语句

-   格式化和缩进

-   把代码发送给AI，简化我的代码？

------------------------------------------------------------------------

### 实例：如何把AI生成的代码内化成自己的代码？

-   iris数据的支持向量机分析

-   Support Vector Machine，简称SVM

    -   机器学习算法，用于分类和回归问题，找到一个最优的超平面或决策边界，将不同类别的样本点分隔开。

-   糖尿病类型的支持向量机分析

------------------------------------------------------------------------

### 提示语：思路

从R自带数据过渡到模拟数据，再过渡到自己的真实数据

> 🧭 提示语: 基于iris数据，开展支持向量机分析，给出R代码?

> 🧭 提示语: 创建 500 个糖尿病患者的模拟数据，包括患者的年齢，BMI，血糖，胰岛素，腰围，锻炼，饮食，饮酒和吸烟习惯，糖尿病类型（1型，2型和隐性糖尿病型）。

------------------------------------------------------------------------

### 🧭 提示语: 基于iris数据，开展支持向量机分析，给出R代码?

DeepSeek输出的代码

```{r}
#| echo: TRUE
#| results: "hide"
#| fig-width: 15
#| fig-height: 8
#| collapse: TRUE

# 1. 加载必要包
library(e1071)    # SVM实现
library(caret)    # 数据分割与模型评估
library(ggplot2)  # 可视化

# 2. 数据准备
data(iris)        # 加载数据集
set.seed(123)     # 设定随机种子

# 查看数据结构
head(iris)
summary(iris)

# 划分训练集（70%）和测试集（30%）
train_index <- createDataPartition(iris$Species, p = 0.7, list = FALSE)
train_data <- iris[train_index, ]
test_data <- iris[-train_index, ]

# 3. 训练SVM模型
svm_linear <- svm(Species ~ ., 
                  data = train_data, 
                  kernel = "linear", 
                  cost = 1)
summary(svm_linear)

# 4. 模型评估
pred_linear <- predict(svm_linear, test_data)

# 计算准确率
cat("线性核准确率:\n")
print(confusionMatrix(pred_linear, test_data$Species))

```

------------------------------------------------------------------------

### 请求DeepSeek生成模拟数据

> 🧭 提示语: 创建 500 个糖尿病患者的模拟数据，包括患者的年齢，BMI，血糖，胰岛素，腰围，锻炼，饮食，饮酒和吸烟习惯，糖尿病类型（1型，2型和隐性糖尿病型）。

DeepSeek输出的代码

```{r}
#| echo: TRUE
#| results: "hide"
#| fig-width: 15
#| fig-height: 8
#| collapse: TRUE

# 设置随机种子
set.seed(42)

# 创建 500 个糖尿病患者的模拟数据
n <- 500

# 模拟数据：使用 replicate 简化生成过程
diabetes <- data.frame(
  age = sample(18:80, n, replace = TRUE),
  bmi = runif(n, 18.5, 40),
  glucose = runif(n, 70, 200),
  insulin = runif(n, 5, 30),
  waist = runif(n, 70, 130),
  exercise = sample(c(0, 1), n, replace = TRUE),
  diet = sample(c(0, 1), n, replace = TRUE),
  alcohol = sample(c(0, 1), n, replace = TRUE),
  smoking = sample(c(0, 1), n, replace = TRUE),
  type = sample(c("Type1", "Type2", "LADA"), n, replace = TRUE)
)

# 查看数据的前几行
head(diabetes)

```

---------

## 总结

> AI助力，让R语言学习变得简单、高效、充满乐趣！

> AI助力, 形成编程思维, 独立实践才是用好R的关键。

> 高质量的提问，源自对R的深度使用。\
> \

