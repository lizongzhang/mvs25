{
  "hash": "6483da20360ea45c77041c22f8ecaf63",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle:  \"R快速入门\"\ndate: today\nauthor: \n  name: \"李宗璋\"\n  url: https://space.bilibili.com/590872906/\nformat: \n  revealjs:\n    incremental: FALSE\n    theme: sky\n    slide-number: true\n    code-fold: false\n    execute:\n      echo: true\n      output: true        \n      warning: false\n      message: false\n    chalkboard: \n      buttons: true\n    preview-links: auto\n    css: styles.css\n    footer: |\n      <https://lizongzhang.github.io/mvs25><br>© Li Zongzhang \n    include-before-body: \n      - header.html\n      - fonts.html\n    title-slide-attributes: \n      data-background-image: \"img/bili_up.JPG\"  \n      data-background-size: \"100px\"        \n      data-background-position: \"center bottom 200px\"  \n    plugins: [highlight, zoom, notes]\neditor: \n  markdown: \n    wrap: 72\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n------------------------------------------------------------------------\n\n## 大纲\n\n-   1.1 R主界面\n\n-   1.2 安装包\n\n-   1.3 项目的创建与管理\n\n-   1.4 R代码学习方法建议\n\n-   1.5 常用R代码\n\n------------------------------------------------------------------------\n\n## 1.1 RStudio的界面\n\n\n\n\n------------------------------------------------------------------------\n\n## 1.2 安装包\n\n-   tidyverse\n\n    -   一系列用于数据导入、清洗、转换、可视化与建模的 R 包\n\n------------------------------------------------------------------------\n\n### R代码: 安装包\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# 安装单个包\ninstall.packages(\"tidyverse\")\n\ninstall.packages(\"psych\")\n\n# 安装多个包\ninstall.packages(c(\"tidyverse\", \"psych\"))\n```\n:::\n\n\n\n------------------------------------------------------------------------\n\n### R代码: 查看包是否需要更新\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\noptions(repos = c(CRAN = \"https://cloud.r-project.org\")) #使用主镜像\navailable.packages()[\"survminer\", \"Version\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"0.5.1\"\n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n### 安装包的常见问题\n\n-   安装包的速度太慢，切换到国内镜像\n\n-   安装了包后，还需要加载包，方可调用包中的函数\n\n-    could not find function \"XXX\"\n\n------------------------------------------------------------------------\n\n## 1.3 项目的创建与管理\n\n-   创建项目的好处\n\n    -   项目创建后，所有相对路径都以项目文件夹为根目录\n\n    -   不再需要使用 setwd() 指定工作目录，减少路径错误\n\n    -   便于协作与再现\n\n    -   团队成员只需克隆项目文件夹，即可重现整个分析过程\n\n--------\n\n- 项目文件的管理\n\n  -   数据文件及其导入\n  \n  -   代码\n  \n  -   导出的文件：图片, Word, PDF等\n\n----------\n\n\n---\n\n## 1.4 R代码学习方法建议\n\n学习代码: 参数项(需要修改的/不需要改动的)\n\n录入代码\n\n查看函数帮助\n\nAI工具的使用\n            \n----\n\n## 1.5 R常用代码\n\n---\n\n### 1.5.1 管道符\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n安装和加载包tidyverse\n\ninstall.packages(\"tidyverse\")\nlibrary(tidyverse)\n\n# %>% 快捷键\n# Windows: Ctrl + Shift + M\n# Mac OS : Cmd + Shift + M\n```\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nx <- runif(10,0,1)\nx\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.27199995 0.75561918 0.65318259 0.37015505 0.89368684 0.76400602\n [7] 0.07089402 0.06731519 0.22157602 0.94254542\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nround(sqrt(abs(log(x))),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 1.14 0.53 0.65 1.00 0.34 0.52 1.63 1.64 1.23 0.24\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\ny <- log(x)\nz <- abs(y)\nw <- sqrt(z)\nv <- round(w,2)\nsort(v)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.24 0.34 0.52 0.53 0.65 1.00 1.14 1.23 1.63 1.64\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nx %>% \n  log() %>% \n  abs() %>% \n  sqrt() %>% \n  round(2) %>% \n  sort()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.24 0.34 0.52 0.53 0.65 1.00 1.14 1.23 1.63 1.64\n```\n\n\n:::\n:::\n\n\n\n----\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npi %>% \n  round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.14\n```\n\n\n:::\n\n```{.r .cell-code}\n2 %>% \n  round(pi,.)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.14\n```\n\n\n:::\n\n```{.r .cell-code}\n6 %>% \n  round(pi,.)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.141593\n```\n\n\n:::\n\n```{.r .cell-code}\n6 %>% \n  round()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6\n```\n\n\n:::\n:::\n\n\n\n----\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#占位符\npaste(1:3, letters[1:3])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"1 a\" \"2 b\" \"3 c\"\n```\n\n\n:::\n\n```{.r .cell-code}\n1:3 %>% \n  paste(.,letters[.])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"1 a\" \"2 b\" \"3 c\"\n```\n\n\n:::\n:::\n\n\n\n---\n\n### 1.5.2 数据管理 \n\n  - 筛选个案：filter()\n  - 选择变量：select() \n  - 追加变量：mutate()\n  - 重命名：rename(新名 = 旧名)\n  - 条件转换：二值转换if_else()\n  - 条件转换：多值转换case_when()\n  \n\n---\n\n#### filter(), select(), mutate()\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndata(mpg)\n\n#1 miles per gallon = 0.425 kilometers per liter\n\nmpg %>% \n  filter(year == 1999) %>% \n  select(displ,cty, hwy,trans) %>% \n  arrange(displ) %>% \n  mutate(cty.kpl = 0.425*cty, \n               hwy.kpl = 0.425*hwy) %>% \n  mutate(transmission = \n           if_else(substring(trans, 1,4) == \"auto\", \n                   \"auto\",\"manual\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 117 × 7\n   displ   cty   hwy trans      cty.kpl hwy.kpl transmission\n   <dbl> <int> <int> <chr>        <dbl>   <dbl> <chr>       \n 1   1.6    28    33 manual(m5)   11.9     14.0 manual      \n 2   1.6    24    32 auto(l4)     10.2     13.6 auto        \n 3   1.6    25    32 manual(m5)   10.6     13.6 manual      \n 4   1.6    23    29 manual(m5)    9.78    12.3 manual      \n 5   1.6    24    32 auto(l4)     10.2     13.6 auto        \n 6   1.8    18    29 auto(l5)      7.65    12.3 auto        \n 7   1.8    21    29 manual(m5)    8.92    12.3 manual      \n 8   1.8    18    26 manual(m5)    7.65    11.0 manual      \n 9   1.8    16    25 auto(l5)      6.8     10.6 auto        \n10   1.8    24    30 auto(l3)     10.2     12.8 auto        \n# ℹ 107 more rows\n```\n\n\n:::\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpgnew <- mpg %>% \n  filter(year == 1999) %>% \n  select(displ,cty, hwy,trans) %>% \n  arrange(displ) %>% \n  mutate(cty.kpl = 0.425*cty, \n               hwy.kpl = 0.425*hwy) %>% \n  mutate(transmission = \n           if_else(substring(trans, 1,4) == \"auto\", \n                   \"auto\",\"manual\"))\n```\n:::\n\n\n\n---\n\n#### 二值转换 if_else()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#二值转换 if_else\n\nmpg$transmission <- if_else(\n  substring(mpg$trans, 1,4) == \"auto\", \n  \"auto\",\"manual\") \n```\n:::\n\n\n\n----\n\n#### 多值转换 case_when()\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#多值转换 case_when\nmpg$drive <- case_when(\n  mpg$drv == \"f\" ~ \"front-wheel\",\n  mpg$drv == \"r\" ~ \"rear-wheel\",\n  mpg$drv == \"4\" ~ \"four-wheel\")\n```\n:::\n\n\n\n---\n\n#### ggplot2——散点图\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndata(mpg)\n\nmpg %>% \n  ggplot(aes(displ, cty))+\n  geom_point()+\n  geom_smooth(method = lm,\n              se = F)\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n\n\n----\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg %>% \n  ggplot(aes(displ, cty,\n             color = drv,\n             shape = drv))+\n  geom_point()+\n  geom_smooth(method = lm,\n              se = F)\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\n\n----\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg %>% \n  ggplot(aes(displ, cty,\n             size = cyl,\n             shape = drv))+\n  geom_point()+\n  geom_smooth(method = lm,\n              se = F)\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n\n\n----\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg %>% \n  ggplot(aes(displ, cty,\n             color = drv))+\n  geom_point()+\n  geom_smooth(method = lm,\n              se = F)\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n\n----\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg %>% \n  ggplot(aes(displ, cty))+\n  geom_point(aes(color = drv))+\n  geom_smooth(method = lm,\n              se = F)\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-17-1.png){width=960}\n:::\n:::\n\n\n\n----\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg %>% \n  ggplot(aes(displ, cty))+\n  geom_point()+\n  geom_smooth(aes(color = drv),\n              method = lm,\n              se = F)\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmpg %>% \n  ggplot(aes(displ, cty,\n             color = drv))+\n  geom_point()+\n  geom_smooth(method = lm,\n              se = F)+\n  labs(x = \"Engine Size\",\n       y = \"MPG on the Cityway\",\n       title = \"Fuel Efficiency\")+\n  theme_light()+\n  theme(text = element_text(face = \"bold\",\n                            colour = \"blue\"),\n        plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n\n---\n\n#### 描述性统计量的报告\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mpg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n manufacturer          model               displ            year     \n Length:234         Length:234         Min.   :1.600   Min.   :1999  \n Class :character   Class :character   1st Qu.:2.400   1st Qu.:1999  \n Mode  :character   Mode  :character   Median :3.300   Median :2004  \n                                       Mean   :3.472   Mean   :2004  \n                                       3rd Qu.:4.600   3rd Qu.:2008  \n                                       Max.   :7.000   Max.   :2008  \n      cyl           trans               drv                 cty       \n Min.   :4.000   Length:234         Length:234         Min.   : 9.00  \n 1st Qu.:4.000   Class :character   Class :character   1st Qu.:14.00  \n Median :6.000   Mode  :character   Mode  :character   Median :17.00  \n Mean   :5.889                                         Mean   :16.86  \n 3rd Qu.:8.000                                         3rd Qu.:19.00  \n Max.   :8.000                                         Max.   :35.00  \n      hwy             fl               class          \n Min.   :12.00   Length:234         Length:234        \n 1st Qu.:18.00   Class :character   Class :character  \n Median :24.00   Mode  :character   Mode  :character  \n Mean   :23.44                                        \n 3rd Qu.:27.00                                        \n Max.   :44.00                                        \n```\n\n\n:::\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\ndescribe(mpg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              vars   n    mean    sd median trimmed   mad    min  max range\nmanufacturer*    1 234    7.76  5.13    6.0    7.68  5.93    1.0   15  14.0\nmodel*           2 234   19.09 11.15   18.5   18.98 14.08    1.0   38  37.0\ndispl            3 234    3.47  1.29    3.3    3.39  1.33    1.6    7   5.4\nyear             4 234 2003.50  4.51 2003.5 2003.50  6.67 1999.0 2008   9.0\ncyl              5 234    5.89  1.61    6.0    5.86  2.97    4.0    8   4.0\ntrans*           6 234    5.65  2.88    4.0    5.53  1.48    1.0   10   9.0\ndrv*             7 234    1.67  0.66    2.0    1.59  1.48    1.0    3   2.0\ncty              8 234   16.86  4.26   17.0   16.61  4.45    9.0   35  26.0\nhwy              9 234   23.44  5.95   24.0   23.23  7.41   12.0   44  32.0\nfl*             10 234    4.63  0.70    5.0    4.77  0.00    1.0    5   4.0\nclass*          11 234    4.59  1.99    5.0    4.64  2.97    1.0    7   6.0\n               skew kurtosis   se\nmanufacturer*  0.21    -1.63 0.34\nmodel*         0.11    -1.23 0.73\ndispl          0.44    -0.91 0.08\nyear           0.00    -2.01 0.29\ncyl            0.11    -1.46 0.11\ntrans*         0.29    -1.65 0.19\ndrv*           0.48    -0.76 0.04\ncty            0.79     1.43 0.28\nhwy            0.36     0.14 0.39\nfl*           -2.25     5.76 0.05\nclass*        -0.14    -1.52 0.13\n```\n\n\n:::\n:::\n\n\n\n----\n\n#### 绘制学术论文中的表1\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\nlibrary(gt)\nmpg %>% \n  select_if(is.numeric) %>% \n  describe() %>% \n  select(n,mean,sd, median, min,max) %>% \n  round(3) %>% \n  format(nsmall =3) %>% \n  cbind(variable = c(\"displ\",\"year\",\"cyl\",\"cty\",\"hwy\"),.) %>% \n  gt() %>% \n  gtsave(filename = \"table1.docx\")\n```\n:::\n\n\n\n\n---\n\n#### 相关系数及其可视化\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\nlibrary(corrplot)\n\ndata(mtcars)\n\nmtcars %>% \n  select(mpg:qsec) %>% \n  cor() %>% \n  round(3) %>% \n  corrplot(addCoef.col = \"white\",\n           number.cex = 0.8,\n           number.digits = 3,\n           tl.cex = 0.8,\n           tl.col = 1,\n           cl.length = 11,\n           mar = c(1,1,1,1))\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-23-1.png){width=960}\n:::\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmtcars %>% \n  select(mpg:qsec) %>% \n  cor() %>% \n  round(3) %>% \n  corrplot(addCoef.col = \"white\",\n           number.cex = 0.8,\n           number.digits = 3,\n           tl.cex = 0.8,\n           tl.col = 1,\n           cl.length = 11,\n           type = \"upper\",\n           method = \"square\")\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(psych)\n\ngr <- colorRampPalette(c(\"#B52127\", \"white\", \"#2171B5\"))\n\ngr <- colorRampPalette(c(\"purple\", \"white\", \"cyan\"))\n\nmtcars %>% \n  select(mpg:qsec) %>% \n  cor.plot(cex = 0.6,\n           stars = TRUE,\n           gr = gr,\n           cex.axis = 0.8)\n```\n\n::: {.cell-output-display}\n![](Rintro_files/figure-revealjs/unnamed-chunk-25-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "Rintro_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}