<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Li Zongzhang">
<meta name="dcterms.date" content="2025-10-23">

<title>主观态度因子分析 – 多元统计25秋</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c73e22a146e553504ccbb400724ccee0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">多元统计25秋</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./chap1.html"> 
<span class="menu-text">第1章</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./chap4.html"> 
<span class="menu-text">第4章</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./chap5.html"> 
<span class="menu-text">第5章</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./chap6.html"> 
<span class="menu-text">第6章</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./chap7.html"> 
<span class="menu-text">第7章</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./chap8.html"> 
<span class="menu-text">第8章</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./chap9.html"> 
<span class="menu-text">第9章</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./teamwork.html"> 
<span class="menu-text">小组作业</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./schedule.html"> 
<span class="menu-text">课程安排和考核</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="./lizongzhang9@qq.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#数据文件" id="toc-数据文件" class="nav-link active" data-scroll-target="#数据文件">数据文件</a></li>
  <li><a href="#导入数据" id="toc-导入数据" class="nav-link" data-scroll-target="#导入数据">导入数据</a></li>
  <li><a href="#因子分析" id="toc-因子分析" class="nav-link" data-scroll-target="#因子分析">因子分析</a></li>
  <li><a href="#第一轮调整减少原始变量个数" id="toc-第一轮调整减少原始变量个数" class="nav-link" data-scroll-target="#第一轮调整减少原始变量个数">第一轮调整：减少原始变量个数</a></li>
  <li><a href="#第二轮调整减少原始变量个数" id="toc-第二轮调整减少原始变量个数" class="nav-link" data-scroll-target="#第二轮调整减少原始变量个数">第二轮调整：减少原始变量个数</a></li>
  <li><a href="#绘制因子载荷系数图" id="toc-绘制因子载荷系数图" class="nav-link" data-scroll-target="#绘制因子载荷系数图">绘制因子载荷系数图</a></li>
  <li><a href="#计算因子得分" id="toc-计算因子得分" class="nav-link" data-scroll-target="#计算因子得分">计算因子得分</a>
  <ul class="collapse">
  <li><a href="#不同组别因子得分均值的比较" id="toc-不同组别因子得分均值的比较" class="nav-link" data-scroll-target="#不同组别因子得分均值的比较">不同组别因子得分均值的比较</a></li>
  <li><a href="#不同组别因子得分分布的比较" id="toc-不同组别因子得分分布的比较" class="nav-link" data-scroll-target="#不同组别因子得分分布的比较">不同组别因子得分分布的比较</a></li>
  </ul></li>
  <li><a href="#k-means聚类分析" id="toc-k-means聚类分析" class="nav-link" data-scroll-target="#k-means聚类分析">K-means聚类分析</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">主观态度因子分析</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Li Zongzhang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="数据文件" class="level1">
<h1>数据文件</h1>
<p><a href="https://github.com/lizongzhang/mvs25/raw/main/attitude.xlsx" target="_blank" style="text-decoration: none; display: inline-flex; align-items: center;"> <img src="img/download.png" alt="Download icon" style="width: 24px; height: 24px; margin-right: 8px;"> 点击下载数据文件: attitude.xlsx </a></p>
<p>数据文件变量含义：</p>
<p>urban=1,城镇；urban=0, 乡村</p>
<p>male=1, 男性；female=1, 女性</p>
<p>EDU=1，文盲半文盲没上小学；EDU=2，小学；EDU=3，初中；EDU=4，高中/中专/高职；EDU=5，大专/本科/硕士</p>
<p>年龄</p>
<p>主要工作年收入</p>
</section>
<section id="导入数据" class="level1">
<h1>导入数据</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>attitude <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"attitude.xlsx"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>attitude <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"attitude.xlsx"</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>fa_df <span class="ot">&lt;-</span> attitude <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(您人缘关系有多好分<span class="sc">:</span>子女有出息)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="因子分析" class="level1">
<h1>因子分析</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 因子分析</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">principal</span>(fa_df, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nfactors =</span> <span class="dv">10</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rotate =</span> <span class="st">"promax"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>fa_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = fa_df, nfactors = 10, rotate = "promax")
Standardized loadings (pattern matrix) based upon correlation matrix
                         RC1   RC4   RC8   RC9   RC2   RC3   RC6  RC10   RC5
您人缘关系有多好分      0.26  0.28  0.07  0.39 -0.12 -0.10  0.13 -0.13  0.13
您有多幸福分            0.41  0.29 -0.06  0.29  0.13 -0.05  0.04 -0.14 -0.06
对父母的信任度          0.01 -0.21 -0.05  0.98 -0.11 -0.04  0.26 -0.02 -0.14
对邻居的信任度         -0.28 -0.13  0.09  0.75  0.18  0.05 -0.08  0.22  0.24
对美国人的信任度        0.08 -0.01  0.05 -0.10  0.27 -0.07  0.05 -0.19  0.77
对陌生人的信任度       -0.06  0.02 -0.19  0.09  0.04  0.02  0.01  0.02  0.80
对干部的信任度         -0.14 -0.06  0.08  0.03  0.80  0.11 -0.04  0.02  0.21
对医生的信任度          0.14  0.01  0.01 -0.02  0.75  0.08  0.12 -0.04  0.07
公平竞争才有和谐人际    0.07  0.20  0.26  0.18  0.07  0.02  0.89 -0.08  0.04
财富反映个人成就        0.10 -0.02  0.11  0.02 -0.11  0.38  0.50  0.21 -0.06
努力工作能有回报       -0.12 -0.02 -0.16 -0.02  0.27  0.82  0.04 -0.08 -0.11
聪明才干能得回报       -0.03 -0.07 -0.14 -0.01 -0.06  0.88  0.03 -0.08  0.05
成大事难免腐败         -0.16 -0.10  0.92  0.02 -0.01 -0.20  0.23 -0.03 -0.01
有关系比有能力重要     -0.04  0.04  0.13  0.12 -0.56  0.27 -0.08 -0.10  0.07
提高生活水平机会很大   -0.05  0.08 -0.01  0.19  0.07  0.06  0.24 -0.01 -0.02
经济繁荣要拉大收入差距 -0.20 -0.02  0.83 -0.02  0.08 -0.05  0.16 -0.14 -0.11
对自己生活满意度        0.08  0.58  0.03 -0.07  0.25  0.07  0.00 -0.08 -0.13
对自己未来信心程度      0.06  0.45 -0.17  0.16  0.06  0.10 -0.18  0.14 -0.07
您的收入在本地         -0.10  0.95 -0.04 -0.21 -0.06 -0.02  0.17 -0.06  0.03
您的地位               -0.29  1.06 -0.06 -0.12 -0.08 -0.10  0.12  0.28  0.04
很有钱                  0.10  0.14  0.18 -0.18 -0.01 -0.01  0.15  0.60  0.00
不被人讨厌             -0.07  0.13 -0.21  0.18  0.01 -0.10 -0.16  0.88 -0.11
生活有乐趣              0.68 -0.07 -0.14  0.08  0.07 -0.11  0.15  0.26  0.00
与配偶关系亲密          1.06 -0.16 -0.27 -0.09 -0.12 -0.01  0.07 -0.14  0.04
不孤单                  0.69 -0.12  0.05  0.02 -0.02 -0.07 -0.10  0.17  0.02
有成就感                0.50 -0.02  0.06 -0.13  0.00  0.11  0.15  0.27  0.21
死后有人念想            0.25  0.15  0.12 -0.08 -0.16  0.04 -0.32 -0.03  0.21
家庭美满和睦            0.85 -0.07 -0.01 -0.10  0.13 -0.04  0.03 -0.09 -0.10
传宗接代                0.26  0.13  0.31  0.01 -0.08  0.11 -0.16 -0.08 -0.05
子女有出息              0.23 -0.13  0.33  0.04  0.14  0.07 -0.33  0.21 -0.21
                         RC7   h2   u2 com
您人缘关系有多好分      0.00 0.46 0.54 4.0
您有多幸福分           -0.21 0.65 0.35 4.0
对父母的信任度          0.24 0.72 0.28 1.5
对邻居的信任度         -0.05 0.67 0.33 2.0
对美国人的信任度       -0.10 0.67 0.33 1.5
对陌生人的信任度        0.07 0.69 0.31 1.2
对干部的信任度         -0.02 0.68 0.32 1.3
对医生的信任度          0.03 0.63 0.37 1.2
公平竞争才有和谐人际    0.21 0.63 0.37 1.6
财富反映个人成就       -0.01 0.52 0.48 2.7
努力工作能有回报        0.15 0.65 0.35 1.5
聪明才干能得回报       -0.03 0.65 0.35 1.1
成大事难免腐败         -0.13 0.61 0.39 1.4
有关系比有能力重要     -0.40 0.53 0.47 2.8
提高生活水平机会很大    0.79 0.63 0.37 1.4
经济繁荣要拉大收入差距  0.14 0.55 0.45 1.4
对自己生活满意度       -0.17 0.54 0.46 1.9
对自己未来信心程度     -0.03 0.46 0.54 2.4
您的收入在本地          0.10 0.66 0.34 1.2
您的地位                0.10 0.75 0.25 1.4
很有钱                 -0.23 0.55 0.45 2.1
不被人讨厌              0.08 0.70 0.30 1.4
生活有乐趣              0.00 0.54 0.46 1.6
与配偶关系亲密          0.00 0.69 0.31 1.3
不孤单                 -0.02 0.58 0.42 1.3
有成就感                0.14 0.56 0.44 2.7
死后有人念想            0.32 0.62 0.38 5.2
家庭美满和睦           -0.05 0.58 0.42 1.2
传宗接代                0.30 0.62 0.38 4.6
子女有出息             -0.03 0.58 0.42 5.2

                       RC1  RC4  RC8  RC9  RC2  RC3  RC6 RC10  RC5  RC7
SS loadings           3.33 2.43 1.66 1.73 1.92 1.61 1.21 1.59 1.58 1.29
Proportion Var        0.11 0.08 0.06 0.06 0.06 0.05 0.04 0.05 0.05 0.04
Cumulative Var        0.11 0.19 0.25 0.31 0.37 0.42 0.46 0.52 0.57 0.61
Proportion Explained  0.18 0.13 0.09 0.09 0.10 0.09 0.07 0.09 0.09 0.07
Cumulative Proportion 0.18 0.31 0.40 0.50 0.60 0.69 0.76 0.84 0.93 1.00

 With component correlations of 
       RC1   RC4   RC8   RC9   RC2   RC3   RC6  RC10   RC5   RC7
RC1   1.00  0.50  0.38  0.44  0.25  0.28 -0.38  0.31  0.11  0.18
RC4   0.50  1.00  0.29  0.42  0.31  0.27 -0.39 -0.05  0.14  0.12
RC8   0.38  0.29  1.00  0.13 -0.07  0.45 -0.29  0.29  0.08  0.20
RC9   0.44  0.42  0.13  1.00  0.36  0.18 -0.33 -0.04  0.12 -0.03
RC2   0.25  0.31 -0.07  0.36  1.00  0.03 -0.15 -0.09  0.05  0.04
RC3   0.28  0.27  0.45  0.18  0.03  1.00 -0.08  0.22  0.14  0.13
RC6  -0.38 -0.39 -0.29 -0.33 -0.15 -0.08  1.00  0.03 -0.02 -0.21
RC10  0.31 -0.05  0.29 -0.04 -0.09  0.22  0.03  1.00  0.08  0.10
RC5   0.11  0.14  0.08  0.12  0.05  0.14 -0.02  0.08  1.00  0.09
RC7   0.18  0.12  0.20 -0.03  0.04  0.13 -0.21  0.10  0.09  1.00

Mean item complexity =  2.1
Test of the hypothesis that 10 components are sufficient.

The root mean square of the residuals (RMSR) is  0.06 
 with the empirical chi square  1152.74  with prob &lt;  1.7e-141 

Fit based upon off diagonal values = 0.89</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#按因子载荷系数降序排列</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result<span class="sc">$</span>loadings, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">cutoff =</span> <span class="fl">0.5</span>,<span class="at">sort =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
                       RC1    RC4    RC8    RC9    RC2    RC3    RC6    RC10  
生活有乐趣              0.684                                                 
与配偶关系亲密          1.061                                                 
不孤单                  0.690                                                 
有成就感                0.502                                                 
家庭美满和睦            0.853                                                 
对自己生活满意度               0.577                                          
您的收入在本地                 0.949                                          
您的地位                       1.057                                          
成大事难免腐败                        0.922                                   
经济繁荣要拉大收入差距                0.833                                   
对父母的信任度                               0.978                            
对邻居的信任度                               0.753                            
对干部的信任度                                      0.803                     
对医生的信任度                                      0.749                     
有关系比有能力重要                                 -0.557                     
努力工作能有回报                                           0.824              
聪明才干能得回报                                           0.882              
公平竞争才有和谐人际                                              0.890       
很有钱                                                                   0.599
不被人讨厌                                                               0.875
对美国人的信任度                                                              
对陌生人的信任度                                                              
提高生活水平机会很大                                                          
您人缘关系有多好分                                                            
您有多幸福分                                                                  
财富反映个人成就                                                              
对自己未来信心程度                                                            
死后有人念想                                                                  
传宗接代                                                                      
子女有出息                                                                    
                       RC5    RC7   
生活有乐趣                          
与配偶关系亲密                      
不孤单                              
有成就感                            
家庭美满和睦                        
对自己生活满意度                    
您的收入在本地                      
您的地位                            
成大事难免腐败                      
经济繁荣要拉大收入差距              
对父母的信任度                      
对邻居的信任度                      
对干部的信任度                      
对医生的信任度                      
有关系比有能力重要                  
努力工作能有回报                    
聪明才干能得回报                    
公平竞争才有和谐人际                
很有钱                              
不被人讨厌                          
对美国人的信任度        0.766       
对陌生人的信任度        0.801       
提高生活水平机会很大           0.791
您人缘关系有多好分                  
您有多幸福分                        
财富反映个人成就                    
对自己未来信心程度                  
死后有人念想                        
传宗接代                            
子女有出息                          

                 RC1   RC4   RC8   RC9   RC2   RC3   RC6  RC10   RC5   RC7
SS loadings    3.813 2.986 2.178 2.066 1.939 1.845 1.717 1.698 1.595 1.335
Proportion Var 0.127 0.100 0.073 0.069 0.065 0.061 0.057 0.057 0.053 0.045
Cumulative Var 0.127 0.227 0.299 0.368 0.433 0.494 0.551 0.608 0.661 0.706</code></pre>
</div>
</div>
</section>
<section id="第一轮调整减少原始变量个数" class="level1">
<h1>第一轮调整：减少原始变量个数</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 第一轮调整：减少原始变量个数</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 把载荷变为普通矩阵</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(fa_result<span class="sc">$</span>loadings)   <span class="co"># rows = variables, cols = factors</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个变量在所有因子上的最大绝对载荷</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>max_abs_loading <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">abs</span>(L), <span class="dv">1</span>, max)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 找出所有最大绝对载荷 &lt; 0.5 的变量</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>remove_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(max_abs_loading)[max_abs_loading <span class="sc">&lt;</span> threshold]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>remove_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "您人缘关系有多好分" "您有多幸福分"       "财富反映个人成就"  
[4] "对自己未来信心程度" "死后有人念想"       "传宗接代"          
[7] "子女有出息"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 fa_df 中剔除这些变量，得到新的数据集</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fa_df_trim <span class="ot">&lt;-</span> fa_df[, <span class="sc">!</span>(<span class="fu">names</span>(fa_df) <span class="sc">%in%</span> remove_vars), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 重新做主成分/因子分析</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>fa_result_trim <span class="ot">&lt;-</span> <span class="fu">principal</span>(fa_df_trim, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nfactors =</span> <span class="dv">7</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">rotate =</span> <span class="st">"promax"</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">scores =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result_trim, <span class="at">cutoff =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = fa_df_trim, nfactors = 7, rotate = "promax", scores = TRUE)
Standardized loadings (pattern matrix) based upon correlation matrix
                         RC1   RC4   RC2   RC7   RC6   RC5   RC3   h2   u2 com
对父母的信任度          0.17 -0.22  0.76  0.13  0.12 -0.16  0.02 0.52 0.48 1.5
对邻居的信任度          0.16 -0.13  0.70  0.04  0.15  0.25  0.12 0.55 0.45 1.6
对美国人的信任度       -0.05  0.07  0.07 -0.11 -0.03  0.77 -0.01 0.62 0.38 1.1
对陌生人的信任度       -0.02 -0.02 -0.01  0.01  0.03  0.85 -0.16 0.70 0.30 1.1
对干部的信任度         -0.06  0.05  0.40 -0.04 -0.40  0.23  0.06 0.58 0.42 2.7
对医生的信任度          0.08  0.11  0.34 -0.01 -0.45  0.08 -0.03 0.56 0.44 2.1
公平竞争才有和谐人际   -0.06  0.03 -0.01  0.34 -0.11  0.12  0.23 0.29 0.71 2.4
努力工作能有回报       -0.11  0.01  0.09  0.83 -0.11 -0.11 -0.15 0.66 0.34 1.2
聪明才干能得回报       -0.01  0.00  0.09  0.85  0.30  0.02 -0.11 0.64 0.36 1.3
成大事难免腐败         -0.02 -0.07  0.07 -0.19  0.20 -0.03  0.86 0.66 0.34 1.2
有关系比有能力重要      0.04  0.16  0.23  0.13  0.91  0.04  0.16 0.65 0.35 1.3
提高生活水平机会很大    0.02  0.03  0.01  0.22 -0.42 -0.08  0.13 0.31 0.69 1.9
经济繁荣要拉大收入差距 -0.10  0.06  0.06 -0.03 -0.01 -0.19  0.76 0.56 0.44 1.2
对自己生活满意度        0.12  0.62  0.17  0.01  0.01 -0.14  0.01 0.50 0.50 1.3
您的收入在本地         -0.03  0.90 -0.16  0.04  0.13  0.02 -0.04 0.71 0.29 1.1
您的地位                0.06  0.86 -0.28 -0.03  0.03  0.06  0.01 0.68 0.32 1.2
很有钱                  0.44 -0.05 -0.42  0.08  0.01  0.12  0.19 0.47 0.53 2.6
不被人讨厌              0.56 -0.13 -0.20  0.00 -0.22 -0.07 -0.03 0.39 0.61 1.7
生活有乐趣              0.71 -0.04  0.11 -0.08 -0.10 -0.01 -0.04 0.53 0.47 1.1
与配偶关系亲密          0.74  0.04  0.14 -0.01  0.11 -0.03 -0.24 0.58 0.42 1.4
不孤单                  0.76  0.04  0.20 -0.11  0.11 -0.06  0.08 0.60 0.40 1.3
有成就感                0.61  0.03 -0.08  0.17  0.06  0.19  0.13 0.56 0.44 1.5
家庭美满和睦            0.64  0.10  0.13 -0.06 -0.07 -0.11 -0.06 0.48 0.52 1.3

                       RC1  RC4  RC2  RC7  RC6  RC5  RC3
SS loadings           3.01 1.93 1.74 1.57 1.49 1.60 1.46
Proportion Var        0.13 0.08 0.08 0.07 0.06 0.07 0.06
Cumulative Var        0.13 0.21 0.29 0.36 0.42 0.49 0.56
Proportion Explained  0.24 0.15 0.14 0.12 0.12 0.13 0.11
Cumulative Proportion 0.24 0.39 0.52 0.64 0.76 0.89 1.00

 With component correlations of 
      RC1   RC4   RC2   RC7   RC6   RC5   RC3
RC1  1.00  0.14  0.05  0.16 -0.19  0.10  0.13
RC4  0.14  1.00  0.30  0.17 -0.35  0.17  0.08
RC2  0.05  0.30  1.00  0.04 -0.36  0.17 -0.12
RC7  0.16  0.17  0.04  1.00 -0.24  0.21  0.38
RC6 -0.19 -0.35 -0.36 -0.24  1.00 -0.23 -0.10
RC5  0.10  0.17  0.17  0.21 -0.23  1.00  0.10
RC3  0.13  0.08 -0.12  0.38 -0.10  0.10  1.00

Mean item complexity =  1.5
Test of the hypothesis that 7 components are sufficient.

The root mean square of the residuals (RMSR) is  0.07 
 with the empirical chi square  980.92  with prob &lt;  2.5e-138 
 0.3
Fit based upon off diagonal values = 0.81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result_trim<span class="sc">$</span>loadings, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">cutoff =</span> <span class="fl">0.5</span>,<span class="at">sort =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
                       RC1    RC4    RC2    RC7    RC6    RC5    RC3   
不被人讨厌              0.563                                          
生活有乐趣              0.708                                          
与配偶关系亲密          0.738                                          
不孤单                  0.760                                          
有成就感                0.612                                          
家庭美满和睦            0.640                                          
对自己生活满意度               0.624                                   
您的收入在本地                 0.905                                   
您的地位                       0.856                                   
对父母的信任度                        0.763                            
对邻居的信任度                        0.705                            
努力工作能有回报                             0.834                     
聪明才干能得回报                             0.852                     
有关系比有能力重要                                  0.912              
对美国人的信任度                                           0.767       
对陌生人的信任度                                           0.849       
成大事难免腐败                                                    0.860
经济繁荣要拉大收入差距                                            0.761
对干部的信任度                                                         
对医生的信任度                                                         
公平竞争才有和谐人际                                                   
提高生活水平机会很大                                                   
很有钱                                                                 

                 RC1   RC4   RC2   RC7   RC6   RC5   RC3
SS loadings    3.029 2.097 1.882 1.729 1.673 1.625 1.621
Proportion Var 0.132 0.091 0.082 0.075 0.073 0.071 0.070
Cumulative Var 0.132 0.223 0.305 0.380 0.453 0.523 0.594</code></pre>
</div>
</div>
</section>
<section id="第二轮调整减少原始变量个数" class="level1">
<h1>第二轮调整：减少原始变量个数</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 第2轮调整：减少原始变量个数</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 把载荷变为普通矩阵</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(fa_result_trim<span class="sc">$</span>loadings)   <span class="co"># rows = variables, cols = factors</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个变量在所有因子上的最大绝对载荷</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>max_abs_loading <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">abs</span>(L), <span class="dv">1</span>, max)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 找出所有最大绝对载荷 &lt; 0.5 的变量</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>remove_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(max_abs_loading)[max_abs_loading <span class="sc">&lt;</span> threshold]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>remove_vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "对干部的信任度"       "对医生的信任度"       "公平竞争才有和谐人际"
[4] "提高生活水平机会很大" "很有钱"              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 fa_df 中剔除这些变量，得到新的数据集</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fa_df_trim2 <span class="ot">&lt;-</span> fa_df_trim[, <span class="sc">!</span>(<span class="fu">names</span>(fa_df_trim) <span class="sc">%in%</span> remove_vars), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 重新做主成分/因子分析</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>fa_result_trim2 <span class="ot">&lt;-</span> <span class="fu">principal</span>(fa_df_trim2, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nfactors =</span> <span class="dv">6</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">rotate =</span> <span class="st">"promax"</span>, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">scores =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result_trim2<span class="sc">$</span>loadings, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">cutoff =</span> <span class="fl">0.5</span>,<span class="at">sort =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
                       RC1    RC2    RC5    RC4    RC3    RC6   
不被人讨厌              0.528                                   
生活有乐趣              0.715                                   
与配偶关系亲密          0.756                                   
不孤单                  0.758                                   
有成就感                0.661                                   
家庭美满和睦            0.674                                   
对自己生活满意度               0.625                            
您的收入在本地                 0.840                            
您的地位                       0.841                            
对美国人的信任度                      0.789                     
对陌生人的信任度                      0.841                     
努力工作能有回报                             0.847              
聪明才干能得回报                             0.813              
成大事难免腐败                                      0.814       
有关系比有能力重要                                  0.518       
经济繁荣要拉大收入差距                              0.615       
对父母的信任度                                             0.832
对邻居的信任度                                             0.771

                 RC1   RC2   RC5   RC4   RC3   RC6
SS loadings    2.849 1.862 1.507 1.460 1.449 1.387
Proportion Var 0.158 0.103 0.084 0.081 0.080 0.077
Cumulative Var 0.158 0.262 0.345 0.427 0.507 0.584</code></pre>
</div>
</div>
</section>
<section id="绘制因子载荷系数图" class="level1">
<h1>绘制因子载荷系数图</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制因子载荷系数图</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.diagram</span>(fa_result_trim2<span class="sc">$</span>loadings, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch7case_attitude_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="计算因子得分" class="level1">
<h1>计算因子得分</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存最终数据集</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(attitude, fa_result_trim2<span class="sc">$</span>scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="不同组别因子得分均值的比较" class="level2">
<h2 class="anchored" data-anchor-id="不同组别因子得分均值的比较">不同组别因子得分均值的比较</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 分析男性和女性在各个因子上的得分差异</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(male) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"RC"</span>), </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                   mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
   male     RC1     RC2     RC5     RC4     RC3      RC6
  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1     0  0.0186  0.0622  0.0116  0.0158 -0.0526  0.00344
2     1 -0.0372 -0.124  -0.0233 -0.0316  0.105  -0.00689</code></pre>
</div>
</div>
</section>
<section id="不同组别因子得分分布的比较" class="level2">
<h2 class="anchored" data-anchor-id="不同组别因子得分分布的比较">不同组别因子得分分布的比较</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 分析男性和女性在因子1上的得分的分布的直方图</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(RC1, <span class="at">fill =</span> <span class="fu">as.factor</span>(male))) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">col =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Male"</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of RC1 by Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch7case_attitude_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 分析不同教育水平在各个因子上的得分差异因1的分布的直方图</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>final_data <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(RC1, <span class="at">fill =</span> <span class="fu">as.factor</span>(EDU))) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">col =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"EDU"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of RC1 by Education"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch7case_attitude_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="k-means聚类分析" class="level1">
<h1>K-means聚类分析</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 利用6个因子得分进行K-means聚类分析</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># K-means聚类分析</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(final_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"RC"</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                                              年龄, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                                              主要工作总收入), </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">centers =</span><span class="dv">3</span>, </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(kmeans_result<span class="sc">$</span>cluster)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看各聚类中心</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>kmeans_result<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          RC1         RC2         RC5         RC4         RC3          RC6
1 -0.03203950  0.11043648  0.85644877 -0.35187921 -0.44126844 -0.698313749
2 -0.02811000  0.01085293 -0.07286533  0.03163693 -0.05559427 -0.008493651
3  0.04752412 -0.02286470  0.07992319 -0.03562132  0.11139376  0.046073127
      年龄 主要工作总收入
1 35.14286      186486.29
2 31.61847       13317.55
3 30.34868       44529.61</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Li Zongzhang</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Statistics: turning data into insights.</p>
</div>
  </div>
</footer>




</body></html>